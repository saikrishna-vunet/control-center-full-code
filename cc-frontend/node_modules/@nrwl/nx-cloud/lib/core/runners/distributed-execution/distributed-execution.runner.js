const a7_0x375d=['url','../../../utilities/metric-logger','defineProperty','terminalOutput','executionId:\x20','target','../../../utilities/create-no-new-messages-timeout','./split-task-graph-into-stages','projectGraph','Processing\x20task\x20','find','splitTasksIntoStages','Error:','commandStatus','write','logCommand','scheduleTask','Distributed\x20Execution\x20Terminated','nodes','executionStatus','Retrieving\x20artifacts\x20from\x20','run','serializeOverrides','hash','../../api/error-reporter.api','encryptionKey','./distributed-execution.api','start','wait','Command\x20execution\x20failed.','next','completeRunGroupWithError','note','taskId','retrieve','cacheDirectory','error:\x20','push','stdout','success','throw','targetDependencies','assign','Extracting\x20artifacts','../../../utilities/nx-imports','DistributedExecutionApi','__awaiter','then','../../../utilities/environment','createTaskGraph','VERBOSE_LOGGING','../../error/print-run-group-error','ErrorReporterApi','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','../../../utilities/waiter','strictlyOrderedTargets','endTask','printRunGroupError','createStartRequest','runUrl','parse','apply','../../../utilities/serializer-overrides','nxCloudDistributedTasksRunner','status','addVerticalSeparator','done','project','submitRunMetrics','taskGraph','lifeCycle','get','value','length','Waiter','log','Starting\x20distributed\x20command\x20execution','../../file-storage/file-storage','tasks','axiosException','exit','getRunGroup','FileStorage','Unable\x20to\x20complete\x20a\x20run.','values','message','error','criticalErrorMessage','/nx.json','See\x20run\x20details\x20at\x20','completedTasks','./task-graph-creator'];(function(_0x1ecb14,_0x375ddc){const _0x43d3f=function(_0x339209){while(--_0x339209){_0x1ecb14['push'](_0x1ecb14['shift']());}};_0x43d3f(++_0x375ddc);}(a7_0x375d,0xe5));const a7_0x43d3=function(_0x1ecb14,_0x375ddc){_0x1ecb14=_0x1ecb14-0x0;let _0x43d3f=a7_0x375d[_0x1ecb14];return _0x43d3f;};'use strict';var __awaiter=this&&this[a7_0x43d3('0x1')]||function(_0xd67633,_0x47f7f1,_0x130e7f,_0x2841a7){function _0x341ba2(_0x369102){return _0x369102 instanceof _0x130e7f?_0x369102:new _0x130e7f(function(_0x5b44f0){_0x5b44f0(_0x369102);});}return new(_0x130e7f||(_0x130e7f=Promise))(function(_0x293ae7,_0x5f558a){function _0x4a8d9b(_0x37c331){try{_0x2388a1(_0x2841a7[a7_0x43d3('0x4d')](_0x37c331));}catch(_0x9b03e2){_0x5f558a(_0x9b03e2);}}function _0x3bd8de(_0x33adaf){try{_0x2388a1(_0x2841a7[a7_0x43d3('0x57')](_0x33adaf));}catch(_0x32de5b){_0x5f558a(_0x32de5b);}}function _0x2388a1(_0x48fd62){_0x48fd62[a7_0x43d3('0x15')]?_0x293ae7(_0x48fd62[a7_0x43d3('0x1b')]):_0x341ba2(_0x48fd62['value'])[a7_0x43d3('0x2')](_0x4a8d9b,_0x3bd8de);}_0x2388a1((_0x2841a7=_0x2841a7[a7_0x43d3('0x10')](_0xd67633,_0x47f7f1||[]))[a7_0x43d3('0x4d')]());});};Object[a7_0x43d3('0x31')](exports,'__esModule',{'value':!![]});exports[a7_0x43d3('0x12')]=void 0x0;const stripJsonComments=require('strip-json-comments');const fs_1=require('fs');const distributed_execution_api_1=require(a7_0x43d3('0x49'));const file_storage_1=require(a7_0x43d3('0x20'));const e2e_encryption_1=require('../../file-storage/e2e-encryption');const waiter_1=require(a7_0x43d3('0x9'));const environment_1=require(a7_0x43d3('0x3'));const print_run_group_error_1=require(a7_0x43d3('0x6'));const create_no_new_messages_timeout_1=require(a7_0x43d3('0x35'));const metric_logger_1=require(a7_0x43d3('0x30'));const error_reporter_api_1=require(a7_0x43d3('0x47'));const serializer_overrides_1=require(a7_0x43d3('0x11'));const task_graph_creator_1=require(a7_0x43d3('0x2e'));const split_task_graph_into_stages_1=require(a7_0x43d3('0x36'));const {output,workspaceRoot,getOutputs,Cache}=require(a7_0x43d3('0x5b'));class NoopLifeCycle{[a7_0x43d3('0x3f')](_0x2cea6b){}['startTask'](_0x1a5f32){}[a7_0x43d3('0xb')](_0xbb22ae,_0x5e8138){}}function runDistributedExecution(_0x4db44e,_0x44c72e,_0x3041d9,_0x32db1a,_0x78b4ff,_0x316e4f,_0x4adef6){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x32f782=yield _0x4db44e[a7_0x43d3('0x4a')]((0x0,distributed_execution_api_1[a7_0x43d3('0xd')])(_0x316e4f,(0x0,split_task_graph_into_stages_1[a7_0x43d3('0x3a')])(_0x4adef6),_0x44c72e));return yield processTasks(_0x4db44e,_0x32db1a,_0x78b4ff,_0x44c72e,_0x32f782,Object[a7_0x43d3('0x27')](_0x4adef6[a7_0x43d3('0x21')]),_0x3041d9);});}function processTasks(_0x1c7541,_0x5c6057,_0x34e15a,_0x59b2a1,_0x462fb4,_0x34447b,_0x4c8201){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3b5cfb={};const _0x5aa5ba=(0x0,create_no_new_messages_timeout_1['createNoNewMessagesTimeout'])();const _0x43d9b9=new waiter_1[(a7_0x43d3('0x1d'))]();while(!![]){if(environment_1[a7_0x43d3('0x5')]){output[a7_0x43d3('0x4f')]({'title':'Waiting...'});}yield _0x43d9b9[a7_0x43d3('0x4b')]();const _0x5b9c2b=yield _0x1c7541[a7_0x43d3('0x13')](_0x462fb4);if(environment_1['VERBOSE_LOGGING']){output[a7_0x43d3('0x4f')]({'title':'Status\x20update','bodyLines':[a7_0x43d3('0x33')+_0x462fb4,'executionStatus:\x20'+_0x5b9c2b['executionStatus'],'number\x20of\x20completed\x20tasks:\x20'+_0x5b9c2b[a7_0x43d3('0x2d')]['length'],a7_0x43d3('0x53')+_0x5b9c2b['criticalErrorMessage']]});}if(_0x5b9c2b[a7_0x43d3('0x2a')]){output[a7_0x43d3('0x29')]({'title':a7_0x43d3('0x40'),'bodyLines':[a7_0x43d3('0x3b'),_0x5b9c2b['criticalErrorMessage']]});process[a7_0x43d3('0x23')](0x1);}_0x5aa5ba(_0x5b9c2b['completedTasks'][a7_0x43d3('0x1c')]);for(const _0x5e5aa9 of _0x5b9c2b[a7_0x43d3('0x2d')]){if(_0x3b5cfb[_0x5e5aa9[a7_0x43d3('0x50')]])continue;yield processTask(_0x5c6057,_0x34e15a,_0x4c8201,_0x59b2a1,_0x34447b,_0x5e5aa9);_0x43d9b9['reset']();_0x3b5cfb[_0x5e5aa9[a7_0x43d3('0x50')]]=!![];}if(_0x5b9c2b[a7_0x43d3('0x42')]==='COMPLETED'){return{'commandStatus':_0x5b9c2b[a7_0x43d3('0x3c')],'runUrl':_0x5b9c2b[a7_0x43d3('0xe')]};}}});}function processTask(_0x323cb3,_0x2cf516,_0xdfe5e6,_0x24fc8a,_0x28318d,_0x382690){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1[a7_0x43d3('0x5')]){output[a7_0x43d3('0x4f')]({'title':a7_0x43d3('0x38')+_0x382690[a7_0x43d3('0x50')]});}const _0x2becdf=_0x28318d[a7_0x43d3('0x39')](_0x51a7db=>_0x382690['taskId']===_0x51a7db['id']);if(!_0x2becdf){throw new Error('Found\x20unknown\x20task:\x20'+_0x382690[a7_0x43d3('0x50')]);}if(environment_1[a7_0x43d3('0x5')]){output['note']({'title':a7_0x43d3('0x43')+_0x382690['url']});}yield _0x323cb3[a7_0x43d3('0x51')](_0x382690[a7_0x43d3('0x46')],_0x382690[a7_0x43d3('0x2f')],_0x24fc8a[a7_0x43d3('0x52')]||'./node_modules/.cache/nx');const _0x5e31d6=yield _0x2cf516[a7_0x43d3('0x1a')](Object[a7_0x43d3('0x59')](Object[a7_0x43d3('0x59')]({},_0x2becdf),{'hash':_0x382690[a7_0x43d3('0x46')]}));const _0x2190ad=getOutputs(_0xdfe5e6[a7_0x43d3('0x37')][a7_0x43d3('0x41')],_0x2becdf);if(environment_1['VERBOSE_LOGGING']){output[a7_0x43d3('0x4f')]({'title':a7_0x43d3('0x5a'),'bodyLines':_0x2190ad});}yield _0x2cf516['copyFilesFromCache'](_0x382690['hash'],_0x5e31d6,_0x2190ad);output[a7_0x43d3('0x3e')](getCommand(_0x2becdf));process[a7_0x43d3('0x55')][a7_0x43d3('0x3d')](_0x5e31d6[a7_0x43d3('0x32')]);output[a7_0x43d3('0x14')]();});}function getCommand(_0x159854){const _0x34526d=_0x159854[a7_0x43d3('0x34')]['configuration']?':'+_0x159854[a7_0x43d3('0x34')]['configuration']:'';return['nx',a7_0x43d3('0x44'),_0x159854[a7_0x43d3('0x34')][a7_0x43d3('0x16')]+':'+_0x159854[a7_0x43d3('0x34')]['target']+_0x34526d,(0x0,serializer_overrides_1[a7_0x43d3('0x45')])(_0x159854)]['join']('\x20');}const nxCloudDistributedTasksRunner=(_0x29ca14,_0x84d231,_0x4229b8)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(environment_1[a7_0x43d3('0x5')]){output[a7_0x43d3('0x4f')]({'title':a7_0x43d3('0x1f')});}_0x84d231[a7_0x43d3('0x19')]=new NoopLifeCycle();const _0x5a5f80=(0x0,environment_1[a7_0x43d3('0x24')])();if(!_0x5a5f80){(0x0,print_run_group_error_1[a7_0x43d3('0xc')])();return process[a7_0x43d3('0x23')](0x1);}const _0x41c1ff=new e2e_encryption_1['E2EEncryption'](environment_1['ENCRYPTION_KEY']||_0x84d231[a7_0x43d3('0x48')]);const _0x419505=new error_reporter_api_1[(a7_0x43d3('0x7'))](_0x84d231);const _0x433fde=new file_storage_1[(a7_0x43d3('0x25'))](_0x41c1ff,_0x419505,!![]);const _0x546861=new Cache(_0x84d231);const _0x3d9ecb=new distributed_execution_api_1[(a7_0x43d3('0x0'))](_0x84d231);try{const _0x2f26cf=getTaskGraph(_0x4229b8,_0x29ca14,_0x84d231);const _0x39117d=yield runDistributedExecution(_0x3d9ecb,_0x84d231,_0x4229b8,_0x433fde,_0x546861,_0x5a5f80,_0x2f26cf);if(_0x39117d[a7_0x43d3('0x3c')]===0x0){output[a7_0x43d3('0x56')]({'title':'Successfully\x20completed\x20running\x20the\x20command.','bodyLines':[a7_0x43d3('0x2c')+_0x39117d[a7_0x43d3('0xe')]]});}else{output['error']({'title':a7_0x43d3('0x4c'),'bodyLines':[a7_0x43d3('0x2c')+_0x39117d[a7_0x43d3('0xe')]]});}yield(0x0,metric_logger_1[a7_0x43d3('0x17')])(_0x84d231);process[a7_0x43d3('0x23')](_0x39117d[a7_0x43d3('0x3c')]);}catch(_0x30628d){output[a7_0x43d3('0x29')]({'title':a7_0x43d3('0x26'),'bodyLines':[_0x30628d[a7_0x43d3('0x28')]]});if(_0x30628d[a7_0x43d3('0x22')]){console[a7_0x43d3('0x1e')](_0x30628d[a7_0x43d3('0x22')]);}else{console[a7_0x43d3('0x1e')](_0x30628d);}try{yield _0x3d9ecb[a7_0x43d3('0x4e')](_0x5a5f80,a7_0x43d3('0x8')+_0x30628d[a7_0x43d3('0x28')]+'\x22');}finally{process[a7_0x43d3('0x23')](0x1);}}});exports[a7_0x43d3('0x12')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x8eb455,_0x128698,_0x254048){if(_0x8eb455[a7_0x43d3('0x18')]){return _0x8eb455[a7_0x43d3('0x18')];}else{const _0x4d9244=JSON[a7_0x43d3('0xf')](stripJsonComments((0x0,fs_1['readFileSync'])(workspaceRoot+a7_0x43d3('0x2b'))['toString']()));return new task_graph_creator_1['TaskGraphCreator'](_0x8eb455['projectGraph'],getDefaultDependencyConfigs(_0x4d9244,_0x254048))[a7_0x43d3('0x4')](_0x128698);}}function getDefaultDependencyConfigs(_0x21e48f,_0x15e7ac){var _0x527733,_0x33b5ca;const _0x56fdd6=(_0x527733=_0x21e48f[a7_0x43d3('0x58')])!==null&&_0x527733!==void 0x0?_0x527733:{};const _0x4b24cc=_0x15e7ac?(_0x33b5ca=_0x15e7ac[a7_0x43d3('0xa')])!==null&&_0x33b5ca!==void 0x0?_0x33b5ca:['build']:[];for(const _0x5ecc82 of _0x4b24cc){_0x56fdd6[_0x5ecc82]=_0x56fdd6[_0x5ecc82]||[];_0x56fdd6[_0x5ecc82][a7_0x43d3('0x54')]({'target':_0x5ecc82,'projects':'dependencies'});}return _0x56fdd6;}