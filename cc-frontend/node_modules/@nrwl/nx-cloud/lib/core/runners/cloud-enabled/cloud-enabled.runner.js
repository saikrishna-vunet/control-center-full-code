const a1_0x5d24=['../../api/error-reporter.api','waitForStoreRequestsToComplete','FileStorage','VERBOSE_LOGGING','../../terminal-output/message-reporter','join','ErrorReporterApi','__esModule','obfuscate','complete','endRun','../../file-storage/e2e-encryption','value','CloudEnabledLifeCycle','./cloud-enabled-life-cycle','forEach','defineProperty','OutputObfuscator','requests','printCacheHitsMessage','lifeCycle','writeFileSync','../../terminal-output/end-of-run-message','submitRunMetrics','../../../utilities/nx-imports','path','anyErrors','rxjs/internal/Subject','next','scan','getRunGroup','subscribe','./cloud-run.api','./cloud-remote-cache','hash','getMachineInfo','encryptionKey','env','filter','maskedProperties','then','cloudEnabledTasksRunner','../../file-storage/file-storage','apply','toISOString','stringify','map','ENCRYPTION_KEY','cacheDirectory','tasks-hashes-','exit','./node_modules/.cache/nx','error','EndOfRunMessage','taskId','CloudRemoteCache','catch','getBranch','printMessages','extractGitSha','DISTRIBUTED_TASK_EXECUTION_INTERNAL_ERROR_STATUS_CODE','cacheableOperations','startRun','assign','AGENT_RUNNING_IN_DISTRIBUTED_EXECUTION','NX_CLOUD_DISTRIBUTED_EXECUTION_ID','throw'];(function(_0xbdc426,_0x5d2414){const _0x13696a=function(_0x50e177){while(--_0x50e177){_0xbdc426['push'](_0xbdc426['shift']());}};_0x13696a(++_0x5d2414);}(a1_0x5d24,0x95));const a1_0x1369=function(_0xbdc426,_0x5d2414){_0xbdc426=_0xbdc426-0x0;let _0x13696a=a1_0x5d24[_0xbdc426];return _0x13696a;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x477d4b,_0x2b64d1,_0x1cc78c,_0x1b5592){function _0x4384a1(_0x42adc6){return _0x42adc6 instanceof _0x1cc78c?_0x42adc6:new _0x1cc78c(function(_0x3b3334){_0x3b3334(_0x42adc6);});}return new(_0x1cc78c||(_0x1cc78c=Promise))(function(_0x1c0c8d,_0x21bf91){function _0x57adc6(_0x149a7a){try{_0x598b49(_0x1b5592[a1_0x1369('0xd')](_0x149a7a));}catch(_0x254b7d){_0x21bf91(_0x254b7d);}}function _0x50ad80(_0x2550b4){try{_0x598b49(_0x1b5592[a1_0x1369('0x33')](_0x2550b4));}catch(_0x217737){_0x21bf91(_0x217737);}}function _0x598b49(_0x2676c2){_0x2676c2['done']?_0x1c0c8d(_0x2676c2[a1_0x1369('0x40')]):_0x4384a1(_0x2676c2[a1_0x1369('0x40')])['then'](_0x57adc6,_0x50ad80);}_0x598b49((_0x1b5592=_0x1b5592[a1_0x1369('0x1c')](_0x477d4b,_0x2b64d1||[]))['next']());});};Object[a1_0x1369('0x1')](exports,a1_0x1369('0x3b'),{'value':!![]});exports['cloudEnabledTasksRunner']=void 0x0;const message_reporter_1=require(a1_0x1369('0x38'));const end_of_run_message_1=require(a1_0x1369('0x7'));const output_obfuscator_1=require('../../terminal-output/output-obfuscator');const cloud_enabled_life_cycle_1=require(a1_0x1369('0x42'));const file_storage_1=require(a1_0x1369('0x1b'));const e2e_encryption_1=require(a1_0x1369('0x3f'));const environment_1=require('../../../utilities/environment');const cloud_remote_cache_1=require(a1_0x1369('0x12'));const cloud_run_api_1=require(a1_0x1369('0x11'));const fs_1=require('fs');const path=require(a1_0x1369('0xa'));const metric_logger_1=require('../../../utilities/metric-logger');const error_reporter_api_1=require(a1_0x1369('0x34'));const {tasksRunner,output}=require(a1_0x1369('0x9'));function createApi(_0x5efe83,_0x5d113f,_0x5d6f5d){const _0x2e2a63=(0x0,environment_1[a1_0x1369('0x14')])(_0x5d113f);return new cloud_run_api_1['CloudRunApi'](_0x5efe83,_0x5d6f5d,_0x5d113f,_0x2e2a63);}function storeTaskHashes(_0x4752e8,_0xeea2de,_0x1ae624){const _0x12aed3=JSON[a1_0x1369('0x1e')](_0x4752e8['map'](_0x5c107e=>({'taskId':_0x5c107e[a1_0x1369('0x27')],'hash':_0x5c107e[a1_0x1369('0x13')]})));if(environment_1[a1_0x1369('0x37')]){output['note']({'title':'Executed\x20tasks\x20with\x20hashes:\x20'+_0x12aed3});}(0x0,fs_1[a1_0x1369('0x6')])(path[a1_0x1369('0x39')](_0xeea2de,a1_0x1369('0x22')+_0x1ae624),_0x12aed3);}function onComplete(_0x59d3c3,_0x2c3308,_0x42e504,_0x2565f3,_0x5b913e,_0x12eb79,_0x545b17,_0x24ee2d,_0x334303,_0x507bd6,_0x4bdab0){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x3cb467=new Date()[a1_0x1369('0x1d')]();if(environment_1[a1_0x1369('0x31')]){storeTaskHashes(_0x334303,_0x2c3308[a1_0x1369('0x21')]||a1_0x1369('0x24'),environment_1[a1_0x1369('0x32')]);}const _0x4fbebf=(0x0,environment_1[a1_0x1369('0x2a')])();const _0x41c47a=yield Promise['all']([_0x42e504[a1_0x1369('0x35')](),_0x2565f3[a1_0x1369('0x3e')]({'command':_0x5b913e[a1_0x1369('0x3c')]((0x0,environment_1['parseCommand'])()),'startTime':_0x12eb79,'endTime':_0x3cb467,'distributedExecutionId':environment_1[a1_0x1369('0x32')],'branch':_0x4fbebf,'scan':!![],'runGroup':(0x0,environment_1[a1_0x1369('0xf')])(),'sha':_0x4fbebf?(0x0,environment_1[a1_0x1369('0x2c')])():undefined,'inner':_0x4bdab0},_0x334303)]);if(_0x507bd6){setTimeout(()=>{_0x545b17[a1_0x1369('0x2b')]();if(!_0x545b17[a1_0x1369('0xb')]&&!_0x4bdab0){_0x24ee2d[a1_0x1369('0x4')]();}},0x0);}else{_0x545b17[a1_0x1369('0x2b')]();if(!_0x545b17[a1_0x1369('0xb')]&&!_0x4bdab0){_0x24ee2d['printCacheHitsMessage']();}}if(environment_1[a1_0x1369('0x31')]){if(!_0x41c47a[0x0]){output[a1_0x1369('0x25')]({'title':'Agent\x20wasn\x27t\x20able\x20to\x20store\x20artifacts'});_0x545b17[a1_0x1369('0x2b')]();process[a1_0x1369('0x23')](environment_1[a1_0x1369('0x2d')]);}if(!_0x41c47a[0x1]){output[a1_0x1369('0x25')]({'title':'Agent\x20wasn\x27t\x20able\x20to\x20record\x20its\x20run'});_0x545b17['printMessages']();process[a1_0x1369('0x23')](environment_1[a1_0x1369('0x2d')]);}}yield(0x0,metric_logger_1[a1_0x1369('0x8')])(_0x2c3308);});}function createLifeCycle(_0x37c0fa,_0x1c8b10,_0x1e499e,_0x2427e1){const _0x53c873=new cloud_enabled_life_cycle_1[(a1_0x1369('0x41'))](_0x37c0fa,_0x1c8b10[a1_0x1369('0x21')],!!_0x1c8b10['skipNxCache'],_0x1c8b10['scan']===undefined?!![]:_0x1c8b10[a1_0x1369('0xe')],_0x1c8b10[a1_0x1369('0x2e')]||[],_0x1e499e,_0x2427e1);try{const {CompositeLifeCycle}=require(a1_0x1369('0x9'));if(!CompositeLifeCycle)return _0x53c873;return new CompositeLifeCycle([_0x1c8b10['lifeCycle'],_0x53c873]);}catch(_0x226a5f){return _0x53c873;}}function cloudEnabledTasksRunner(_0x378bf7,_0x588d6b,_0x48e979,_0x3ae5d=![]){const _0x1e4209={'statuses':{},'scheduledTasks':[],'requests':{},'allTasks':_0x378bf7};const _0x3c8b44=_0x588d6b[a1_0x1369('0x5')]===undefined;const _0x4cda26=[];const _0x337c21=new message_reporter_1['MessageReporter'](_0x588d6b);const _0x205c95=createApi(_0x337c21,_0x588d6b,_0x1e4209);const _0x13346c=new end_of_run_message_1[(a1_0x1369('0x26'))](_0x1e4209,_0x4cda26);const _0x4c6321=new output_obfuscator_1[(a1_0x1369('0x2'))](_0x588d6b[a1_0x1369('0x18')]);const _0x70d329=_0x378bf7[a1_0x1369('0x1f')](_0x452846=>_0x452846[a1_0x1369('0x13')])[a1_0x1369('0x17')](_0x52e0fe=>!!_0x52e0fe);const _0x5a060e=_0x205c95[a1_0x1369('0x2f')](environment_1[a1_0x1369('0x32')],_0x70d329);_0x70d329[a1_0x1369('0x0')](_0x16cb8a=>{_0x1e4209[a1_0x1369('0x3')][_0x16cb8a]=_0x5a060e;});const _0x57254b=new Date()[a1_0x1369('0x1d')]();const _0x2fa492=createLifeCycle(_0x1e4209,_0x588d6b,_0x4c6321,_0x4cda26);const _0x5b7f6c=new e2e_encryption_1['E2EEncryption'](environment_1[a1_0x1369('0x20')]||_0x588d6b[a1_0x1369('0x15')]);const _0x290708=new error_reporter_api_1[(a1_0x1369('0x3a'))](_0x588d6b);const _0x2265ef=new file_storage_1[(a1_0x1369('0x36'))](_0x5b7f6c,_0x290708,![]);const _0x198013=new cloud_remote_cache_1[(a1_0x1369('0x28'))](_0x337c21,_0x205c95,_0x1e4209,_0x2265ef);delete process[a1_0x1369('0x16')][a1_0x1369('0x32')];const _0xf259da=tasksRunner(_0x378bf7,Object[a1_0x1369('0x30')](Object[a1_0x1369('0x30')]({},_0x588d6b),{'remoteCache':_0x198013,'lifeCycle':_0x2fa492}),_0x48e979);if(_0xf259da['subscribe']){const {Subject}=require(a1_0x1369('0xc'));const _0x4917c6=new Subject();_0xf259da[a1_0x1369('0x10')]({'next':_0xc13fca=>_0x4917c6[a1_0x1369('0xd')](_0xc13fca),'error':_0x3e181c=>_0x4917c6[a1_0x1369('0x25')](_0x3e181c),'complete':()=>__awaiter(this,void 0x0,void 0x0,function*(){yield onComplete(_0x2fa492,_0x588d6b,_0x198013,_0x205c95,_0x4c6321,_0x57254b,_0x337c21,_0x13346c,_0x4cda26,_0x3c8b44,_0x3ae5d);_0x4917c6[a1_0x1369('0x3d')]();})});return _0x4917c6;}else{return _0xf259da[a1_0x1369('0x19')](_0x3db86d=>__awaiter(this,void 0x0,void 0x0,function*(){yield onComplete(_0x2fa492,_0x588d6b,_0x198013,_0x205c95,_0x4c6321,_0x57254b,_0x337c21,_0x13346c,_0x4cda26,_0x3c8b44,_0x3ae5d);return _0x3db86d;}))[a1_0x1369('0x29')](_0x4795d7=>__awaiter(this,void 0x0,void 0x0,function*(){yield onComplete(_0x2fa492,_0x588d6b,_0x198013,_0x205c95,_0x4c6321,_0x57254b,_0x337c21,_0x13346c,_0x4cda26,_0x3c8b44,_0x3ae5d);throw _0x4795d7;}));}}exports[a1_0x1369('0x1a')]=cloudEnabledTasksRunner;