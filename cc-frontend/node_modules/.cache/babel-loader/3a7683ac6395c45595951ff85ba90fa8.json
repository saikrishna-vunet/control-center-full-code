{"ast":null,"code":"import * as React from 'react';\nimport { alpha } from '@mui/material/styles';\nimport Box from '@mui/material/Box';\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableHead from '@mui/material/TableHead';\nimport TablePagination from '@mui/material/TablePagination';\nimport TableRow from '@mui/material/TableRow';\nimport TableSortLabel from '@mui/material/TableSortLabel';\nimport Toolbar from '@mui/material/Toolbar';\nimport Typography from '@mui/material/Typography';\nimport Paper from '@mui/material/Paper';\nimport Checkbox from '@mui/material/Checkbox';\nimport IconButton from '@mui/material/IconButton';\nimport Tooltip from '@mui/material/Tooltip';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport { visuallyHidden } from '@mui/utils';\nimport PlayCircleOutlineRoundedIcon from '@mui/icons-material/PlayCircleOutlineRounded';\nimport PauseCircleOutlineRoundedIcon from '@mui/icons-material/PauseCircleOutlineRounded';\nimport AssignmentRoundedIcon from '@mui/icons-material/AssignmentRounded';\nimport VisibilityIcon from '@mui/icons-material/Visibility';\nimport EditIcon from '@mui/icons-material/Edit';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport url_backend from '../configs/url';\nimport { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"@emotion/react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"@emotion/react/jsx-runtime\";\n\nconst actionService = async data => {\n  const request_url = url_backend + '/api/services/';\n\n  try {\n    const response = await axios({\n      method: \"put\",\n      url: request_url,\n      data: JSON.stringify(data),\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    });\n    console.log(response);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nfunction descendingComparator(a, b, orderBy) {\n  if (b[orderBy] < a[orderBy]) {\n    return -1;\n  }\n\n  if (b[orderBy] > a[orderBy]) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction getComparator(order, orderBy) {\n  return order === 'desc' ? (a, b) => descendingComparator(a, b, orderBy) : (a, b) => -descendingComparator(a, b, orderBy);\n} // This method is created for cross-browser compatibility, if you don't\n// need to support IE11, you can use Array.prototype.sort() directly\n\n\nfunction stableSort(array, comparator) {\n  const stabilizedThis = array.map((el, index) => [el, index]);\n  stabilizedThis.sort((a, b) => {\n    const order = comparator(a[0], b[0]);\n\n    if (order !== 0) {\n      return order;\n    }\n\n    return a[1] - b[1];\n  });\n  return stabilizedThis.map(el => el[0]);\n}\n\nconst headCells = [{\n  id: 'name',\n  numeric: false,\n  disablePadding: false,\n  label: 'Name'\n}, {\n  id: 'type',\n  numeric: false,\n  disablePadding: false,\n  label: 'Type'\n}, {\n  id: 'actual_instances',\n  numeric: true,\n  disablePadding: false,\n  label: 'Instances'\n}, {\n  id: 'expected_instances',\n  numeric: true,\n  disablePadding: false,\n  label: 'Nodes'\n}, {\n  id: 'hosts',\n  numeric: false,\n  disablePadding: false,\n  label: 'Node List'\n}];\n\nfunction EnhancedTableHead(props) {\n  const {\n    onSelectAllClick,\n    order,\n    orderBy,\n    numSelected,\n    rowCount,\n    onRequestSort\n  } = props;\n\n  const createSortHandler = property => event => {\n    onRequestSort(event, property);\n  };\n\n  return _jsx(TableHead, {\n    children: _jsxs(TableRow, {\n      children: [_jsx(TableCell, {\n        padding: \"checkbox\",\n        children: _jsx(Checkbox, {\n          color: \"primary\",\n          indeterminate: numSelected > 0 && numSelected < rowCount,\n          checked: rowCount > 0 && numSelected === rowCount,\n          onChange: onSelectAllClick,\n          inputProps: {\n            'aria-label': 'select all services'\n          }\n        })\n      }), headCells.map(headCell => _jsx(TableCell, {\n        align: \"left\" //{headCell.numeric ? 'right' : 'left'}\n        ,\n        padding: headCell.disablePadding ? 'none' : 'normal',\n        sortDirection: orderBy === headCell.id ? order : false,\n        children: _jsxs(TableSortLabel, {\n          active: orderBy === headCell.id,\n          direction: orderBy === headCell.id ? order : 'asc',\n          onClick: createSortHandler(headCell.id),\n          children: [headCell.label, orderBy === headCell.id ? _jsx(Box, {\n            component: \"span\",\n            sx: visuallyHidden,\n            children: order === 'desc' ? 'sorted descending' : 'sorted ascending'\n          }) : null]\n        })\n      }, headCell.id)), _jsx(TableCell, {\n        children: \"Actions\"\n      })]\n    })\n  });\n}\n\n// const EnhancedTableToolbar = (props: EnhancedTableToolbarProps) => {\n//   const { numSelected } = props;\n//   return (\n//     <Toolbar\n//       sx={{\n//         pl: { sm: 2 },\n//         pr: { xs: 1, sm: 1 },\n//         ...(numSelected > 0 && {\n//           bgcolor: (theme) =>\n//             alpha(\n//               theme.palette.primary.main,\n//               theme.palette.action.activatedOpacity\n//             ),\n//         }),\n//       }}\n//     >\n//       {numSelected > 0 ? (\n//         <Typography\n//           sx={{ flex: '1 1 100%' }}\n//           color=\"inherit\"\n//           variant=\"subtitle1\"\n//           component=\"div\"\n//         >\n//           {numSelected} selected\n//         </Typography>\n//       ) : (\n//         <Typography\n//           sx={{ flex: '1 1 100%' }}\n//           variant=\"h6\"\n//           id=\"tableTitle\"\n//           component=\"div\"\n//         >\n//           Services\n//         </Typography>\n//       )}\n//       {numSelected > 0 ? (\n//         <>\n//           <Tooltip title=\"Start Service\">\n//             <IconButton>\n//               <PlayCircleOutlineRoundedIcon />\n//             </IconButton>\n//           </Tooltip>\n//           <Tooltip title=\"Stop Service\">\n//             <IconButton>\n//               <PauseCircleOutlineRoundedIcon />\n//             </IconButton>\n//           </Tooltip>\n//           <Tooltip title=\"Delete\">\n//             <IconButton>\n//               <DeleteIcon />\n//             </IconButton>\n//           </Tooltip>\n//         </>\n//       ) : (\n//         <Tooltip title=\"Expanded view\">\n//           <IconButton onClick={routeChangeContainer}>\n//             <AssignmentRoundedIcon />\n//           </IconButton>\n//         </Tooltip>\n//       )}\n//     </Toolbar>\n//   );\n// };\nexport const ServicesTableActions = ({\n  data\n}) => {\n  const navigate = useNavigate();\n\n  const routeChangeView = name => {\n    const path = `/app/controlcenter/ServicesInfo`;\n    navigate(path, {\n      state: {\n        id: name\n      }\n    });\n  };\n\n  const routeChangeEdit = name => {\n    const path = `/app/controlcenter/EditServices`;\n    navigate(path, {\n      state: {\n        id: name\n      }\n    });\n  };\n\n  const routeChangeContainer = () => {\n    const path = `/app/controlcenter/Containers`;\n    navigate(path);\n  };\n\n  const [orderBy, setOrderBy] = React.useState('name');\n  const [order, setOrder] = React.useState('asc');\n  const [selected, setSelected] = React.useState([]);\n  const [page, setPage] = React.useState(0);\n  const [dense, setDense] = React.useState(true);\n  const [rowsPerPage, setRowsPerPage] = React.useState(5);\n  const [searched, setSearched] = React.useState('');\n  const [numSelected, setNums] = React.useState(0);\n  const [rows1, setRows1] = React.useState(data);\n  React.useEffect(() => {\n    setRows1(data);\n    setNums(selected.length);\n  }, [data, selected.length]);\n\n  const requestSearch = searchedVal => {\n    const filteredRows = data.filter(row => {\n      return row.name.toLowerCase().includes(searchedVal.toLowerCase());\n    });\n    setRows1(filteredRows);\n  };\n\n  const cancelSearch = () => {\n    setSearched('');\n    requestSearch(searched);\n  };\n\n  const handleRequestSort = (event, property) => {\n    const isAsc = orderBy === property && order === 'asc';\n    setOrder(isAsc ? 'desc' : 'asc');\n    setOrderBy(property);\n  };\n\n  const handleSelectAllClick = event => {\n    if (event.target.checked) {\n      const newSelecteds = rows1.map(n => n.name);\n      setSelected(newSelecteds);\n      return;\n    }\n\n    setSelected([]);\n  };\n\n  const handleClick = (event, name) => {\n    const selectedIndex = selected.indexOf(name);\n    let newSelected = [];\n\n    if (selectedIndex === -1) {\n      newSelected = newSelected.concat(selected, name);\n    } else if (selectedIndex === 0) {\n      newSelected = newSelected.concat(selected.slice(1));\n    } else if (selectedIndex === selected.length - 1) {\n      newSelected = newSelected.concat(selected.slice(0, -1));\n    } else if (selectedIndex > 0) {\n      newSelected = newSelected.concat(selected.slice(0, selectedIndex), selected.slice(selectedIndex + 1));\n    }\n\n    setSelected(newSelected);\n  };\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = event => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const handleServicesView = (event, name) => {\n    console.log(name);\n    event.preventDefault();\n    event.stopPropagation();\n    routeChangeView(name);\n  };\n\n  const handleServicesEdit = (event, name) => {\n    console.log(name);\n    event.preventDefault();\n    event.stopPropagation();\n    routeChangeEdit(name);\n  };\n\n  const startService = () => {\n    console.log(selected);\n    let temp = {};\n    selected.forEach(function (item, index) {\n      temp = {\n        \"name\": item,\n        \"action\": \"start\"\n      };\n      actionService(temp);\n    });\n  };\n\n  const stopService = () => {\n    console.log(selected);\n    let temp = {};\n    selected.forEach(function (item, index) {\n      temp = {\n        \"name\": item,\n        \"action\": \"stop\"\n      };\n      actionService(temp);\n    });\n  };\n\n  const isSelected = name => selected.indexOf(name) !== -1; // Avoid a layout jump when reaching the last page with empty rows.\n\n\n  const emptyRows = page > 0 ? Math.max(0, (1 + page) * rowsPerPage - data.length) : 0;\n  return _jsx(Box, {\n    sx: {\n      width: '100%'\n    },\n    children: _jsxs(Paper, {\n      sx: {\n        width: '100%',\n        mb: 2\n      },\n      elevation: 3,\n      children: [_jsxs(Toolbar, {\n        sx: Object.assign({\n          pl: {\n            sm: 2\n          },\n          pr: {\n            xs: 1,\n            sm: 1\n          }\n        }, numSelected > 0 && {\n          bgcolor: theme => alpha(theme.palette.primary.main, theme.palette.action.activatedOpacity)\n        }),\n        children: [numSelected > 0 ? _jsxs(Typography, {\n          sx: {\n            flex: '1 1 100%'\n          },\n          color: \"inherit\",\n          variant: \"subtitle1\",\n          component: \"div\",\n          children: [numSelected, \" selected\"]\n        }) : _jsx(Typography, {\n          sx: {\n            flex: '1 1 100%'\n          },\n          variant: \"h6\",\n          id: \"tableTitle\",\n          component: \"div\",\n          children: \"Services\"\n        }), numSelected > 0 ? _jsxs(_Fragment, {\n          children: [_jsx(Tooltip, {\n            title: \"Start Service\",\n            children: _jsx(IconButton, {\n              onClick: startService,\n              children: _jsx(PlayCircleOutlineRoundedIcon, {})\n            })\n          }), _jsx(Tooltip, {\n            title: \"Stop Service\",\n            children: _jsx(IconButton, {\n              onClick: stopService,\n              children: _jsx(PauseCircleOutlineRoundedIcon, {})\n            })\n          }), _jsx(Tooltip, {\n            title: \"Delete\",\n            children: _jsx(IconButton, {\n              children: _jsx(DeleteIcon, {})\n            })\n          })]\n        }) : _jsx(_Fragment, {\n          children: _jsx(Tooltip, {\n            title: \"Expanded view\",\n            children: _jsx(IconButton, {\n              onClick: routeChangeContainer,\n              children: _jsx(AssignmentRoundedIcon, {})\n            })\n          })\n        })]\n      }), _jsx(Paper, {\n        sx: {\n          width: '20%',\n          textAlign: 'center'\n        }\n      }), _jsx(TableContainer, {\n        children: _jsxs(Table, {\n          sx: {\n            minWidth: 70\n          },\n          \"aria-labelledby\": \"tableTitle\",\n          size: dense ? 'small' : 'medium',\n          children: [_jsx(EnhancedTableHead, {\n            numSelected: selected.length,\n            order: order,\n            orderBy: orderBy,\n            onSelectAllClick: handleSelectAllClick,\n            onRequestSort: handleRequestSort,\n            rowCount: rows1.length\n          }), _jsxs(TableBody, {\n            children: [rows1.slice().sort(getComparator(order, orderBy)).slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage).map((row, index) => {\n              const isItemSelected = isSelected(row.name);\n              const labelId = `enhanced-table-checkbox-${index}`;\n              return _jsxs(TableRow, {\n                hover: true,\n                onClick: event => handleClick(event, row.name),\n                role: \"checkbox\",\n                \"aria-checked\": isItemSelected,\n                tabIndex: -1,\n                selected: isItemSelected,\n                sx: {\n                  padding: 'checkbox'\n                },\n                children: [_jsx(TableCell, {\n                  padding: \"checkbox\",\n                  children: _jsx(Checkbox, {\n                    color: \"primary\",\n                    checked: isItemSelected,\n                    inputProps: {\n                      'aria-labelledby': labelId\n                    }\n                  })\n                }), _jsx(TableCell, {\n                  component: \"th\",\n                  id: labelId,\n                  scope: \"row\",\n                  padding: \"none\",\n                  align: \"left\",\n                  children: row.name\n                }), _jsx(TableCell, {\n                  align: \"left\",\n                  children: row.type\n                }), _jsx(TableCell, {\n                  align: \"left\",\n                  children: JSON.stringify(row.actual_instances) + '/' + JSON.stringify(row.expected_instances)\n                }), _jsx(TableCell, {\n                  align: \"left\",\n                  children: row.hosts.length\n                }), _jsx(TableCell, {\n                  align: \"left\",\n                  children: JSON.stringify(row.hosts, null, 2)\n                }), _jsxs(TableCell, {\n                  align: \"left\",\n                  children: [_jsx(Tooltip, {\n                    title: \"Services Detail\",\n                    children: _jsx(IconButton, {\n                      onClick: event => handleServicesView(event, row._id),\n                      children: _jsx(VisibilityIcon, {\n                        sx: {\n                          fontSize: 20\n                        }\n                      })\n                    })\n                  }), _jsx(Tooltip, {\n                    title: \"Edit\",\n                    children: _jsx(IconButton, {\n                      onClick: event => handleServicesEdit(event, row._id),\n                      children: _jsx(EditIcon, {\n                        sx: {\n                          fontSize: 20\n                        }\n                      })\n                    })\n                  })]\n                })]\n              }, row.name);\n            }), emptyRows > 0 && _jsx(TableRow, {\n              style: {\n                height: (dense ? 33 : 53) * emptyRows\n              },\n              children: _jsx(TableCell, {\n                colSpan: 6\n              })\n            })]\n          })]\n        })\n      }), _jsx(TablePagination, {\n        rowsPerPageOptions: [5, 10, 25],\n        component: \"div\",\n        count: rows1.length,\n        rowsPerPage: rowsPerPage,\n        page: page,\n        onPageChange: handleChangePage,\n        onRowsPerPageChange: handleChangeRowsPerPage\n      })]\n    })\n  });\n};","map":null,"metadata":{},"sourceType":"module"}